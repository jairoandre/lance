<ui:composition
  template="/templates/layout.xhtml"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:p="http://primefaces.org/ui"
  xmlns:lance="http://java.sun.com/jsf/composite/lance">
  <ui:define name="content">
    <h:form id="form">
      <p:panel header="Lançamentos">
        <p:dataTable id="dataTable" value="#{entryController.entries}"
                     var="entry" emptyMessage="Sem entradas" rowIndexVar="index">
          <p:column headerText="Serviço" styleClass="left-align">
            <h:outputText value="#{entry.service.title}"/>
          </p:column>
          <p:column headerText="Valor lançado" styleClass="left-align" width="150">
            <h:outputText value="#{entry.totalValue}">
              <f:convertNumber minFractionDigits="2" pattern="R$ #,##0.00"/>
            </h:outputText>
          </p:column>
          <p:column headerText="Criação" styleClass="left-align" width="100">
            <h:outputText value="#{entry.createdOn}"
                          rendered="#{entry.status != 'N'}">
              <f:convertDateTime pattern="dd/MM/yyyy"/>
            </h:outputText>
            <h:outputText value="-" rendered="#{entry.status == 'N'}"/>
          </p:column>
          <p:column headerText="Vigência" styleClass="left-align" width="100">
            <h:outputText value="#{entry.effectiveOn}"
                          rendered="#{entry.effectiveOn != null}">
              <f:convertDateTime pattern="MM/yyyy"/>
            </h:outputText>
            <h:outputText value="-"
                          rendered="#{entry.effectiveOn == null}"/>
          </p:column>
          <p:column headerText="Estado" styleClass="left-align" width="100">
            <lance:entryStatus status="#{entry.status}"/>
          </p:column>
          <p:column headerText="Ações" width="100" styleClass="action-link">
            <p:commandLink id="editEntry"
                           action="#{entryController.edit(entry)}">
              <span class="fa fa-pencil"/>
            </p:commandLink>
            <p:tooltip id="tooltipEditEntry" for="editEntry"
                       value="Editar #{cc.attrs.controller.entityName}"/>
            <span/>
            <p:commandLink id="validateEntry"
                           action="#{entryController.validate(entry)}"
                           disabled="#{entry.status != 'L' and entry.status != 'F'}">
              <span class="fa fa-gavel"/>
            </p:commandLink>
            <p:tooltip id="tooltipValidateEntry" for="validateEntry"
                       value="Validar #{cc.attrs.controller.entityName}"/>
            <span/>
            <p:commandLink id="sendEditEntry"
                           action="#{entryController.edit(entry)}"
                           disabled="#{entry.status != 'V'}">
              <span class="fa fa-calculator"/>
            </p:commandLink>
            <p:tooltip id="tooltipSendEditEntry" for="sendEditEntry"
                       value="Emitir #{cc.attrs.controller.entityName}"/>
          </p:column>
        </p:dataTable>
      </p:panel>
    </h:form>
  </ui:define>
</ui:composition>