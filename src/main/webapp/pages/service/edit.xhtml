<ui:composition template="/templates/layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:lance="http://java.sun.com/jsf/composite/lance"
	xmlns:uilance="http://vah.com.br/lance">
	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="id" value="#{serviceController.id}" />
			<f:viewParam name="editing" value="#{serviceController.editing}" />
			<f:viewAction action="#{serviceController.onLoad}" />
		</f:metadata>
	</ui:define>
	<ui:define name="content">
		<h:form id="form">

			<p:dialog widgetVar="defaultHistoryDlg" modal="true"
				header="SELECIONAR HISTÓRICO PADRÃO" width="40%">
				<p:ajax event="close" update=":#{p:component('defaultHistory_Pnl')}" />
				<h:panelGroup id="defaultHistoryDlgContent">
					<lance:dataTable id="defaultHistoryOptions"
						controller="#{defaultHistoryController}" renderAddBtn="false"
						renderActionColumn="false">
						<p:column style="text-align: center; #{serviceController.selectedDefaultHistory(item) ? 'background: cyan;' : ''}" width="50">
							<p:commandLink
								actionListener="#{serviceController.toggleDefaultHistory(item)}"
								ajax="true" styleClass="action-link" process="@this"
								update=":#{p:component('defaultHistoryDlgContent')}">
								<span
									class="fa fa#{serviceController.selectedDefaultHistory(item) ? '-dot' : ''}-circle-o" />
							</p:commandLink>
						</p:column>
						<p:column sortBy="#{item.title}" headerText="Descrição"
							style="text-align: left;#{serviceController.selectedDefaultHistory(item) ? 'background: cyan;' : ''}">
							<h:outputText value="#{item.title}" />
						</p:column>
					</lance:dataTable>
				</h:panelGroup>
				<f:facet name="footer">
					<p:commandButton id="closeDefaultHistoryDlgBtn" ajax="true"
						onclick="PF('defaultHistoryDlg').hide()" value="Fechar diálogo" />
				</f:facet>
			</p:dialog>

			<lance:editForm id="sectorPnl" controller="#{serviceController}"
				columns="3">
				<uilance:inputText id="name" label="Nome"
					value="#{serviceController.item.title}"
					editing="#{serviceController.editing}" required="true" />
				<uilance:manyToOne id="defaultHistory" dialog="defaultHistoryDlg"
					editing="#{serviceController.editing}" label="Histórico padrão"
					required="true"
					title="#{serviceController.item.defaultHistory.title}"
					value="#{serviceController.item.defaultHistory.id}" />
				<uilance:inputText id="documentType" label="Tipo de documento"
					value="#{serviceController.item.documentType}"
					editing="#{serviceController.editing}" required="true" />
				<uilance:inputText id="ledgerAccount" label="Conta contábil"
					value="#{serviceController.item.ledgerAccount}"
					editing="#{serviceController.editing}" required="true" />
				<uilance:selectBoolean id="billable" label="Gera nota"
					value="#{serviceController.item.billable}"
					editing="#{serviceController.editing}" required="true" />
				<uilance:selectBoolean id="groupable" label="Faturável"
					value="#{serviceController.item.groupable}"
					editing="#{serviceController.editing}" required="true" />
			</lance:editForm>
		</h:form>
	</ui:define>
</ui:composition>